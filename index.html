<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NFT STARS - Tap & Earn</title>
    <script src="https://telegram.org"></script>
    <style>
        :root { --bg: #0b0e11; --accent: #fcd535; --card: #1e2329; }
        body {
            font-family: 'Inter', sans-serif; background: var(--bg); color: white;
            margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center;
            overflow: hidden; touch-action: none; user-select: none;
        }
        .header { width: 100%; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-sizing: border-box; }
        .balance { font-size: 42px; font-weight: 900; color: var(--accent); margin-top: 20px; display: flex; align-items: center; gap: 10px; }
        
        /* –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ (–ú–æ–Ω–µ—Ç–∞) */
        .click-area {
            flex: 1; display: flex; align-items: center; justify-content: center; width: 100%;
        }
        .coin {
            width: 250px; height: 250px; background: radial-gradient(circle, #fcd535 0%, #f7b500 100%);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 120px; box-shadow: 0 0 50px rgba(252, 213, 53, 0.3);
            cursor: pointer; transition: transform 0.05s;
            border: 8px solid rgba(255,255,255,0.2);
        }
        .coin:active { transform: scale(0.95); }

        /* –≠–Ω–µ—Ä–≥–∏—è */
        .energy-container { width: 80%; margin-bottom: 40px; }
        .energy-bar { width: 100%; height: 12px; background: #333; border-radius: 6px; overflow: hidden; }
        .energy-fill { height: 100%; background: var(--accent); transition: width 0.2s; }
        .energy-text { text-align: center; margin-top: 8px; font-size: 14px; opacity: 0.8; }

        /* –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —Ü–∏—Ñ—Ä—ã */
        .plus-one {
            position: absolute; color: var(--accent); font-size: 24px; font-weight: bold;
            pointer-events: none; animation: floatUp 0.8s forwards; z-index: 100;
        }
        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }
    </style>
</head>
<body>

    <div class="header">
        <div id="u-name" style="font-weight: bold;">PLAYER</div>
        <div style="font-size: 12px; opacity: 0.5;">RANK: STARTER</div>
    </div>

    <div class="balance">
        ‚≠ê <span id="balance">0</span>
    </div>

    <div class="click-area" id="tap-zone">
        <div class="coin" id="coin">üåü</div>
    </div>

    <div class="energy-container">
        <div class="energy-bar">
            <div class="energy-fill" id="energy-fill" style="width: 100%;"></div>
        </div>
        <div class="energy-text">‚ö° <span id="energy-val">1000</span> / 1000</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        let stars = parseInt(localStorage.getItem('tap_stars')) || 0;
        let energy = parseInt(localStorage.getItem('tap_energy')) || 1000;
        const maxEnergy = 1000;

        function updateUI() {
            document.getElementById('balance').innerText = stars;
            document.getElementById('energy-val').innerText = energy;
            document.getElementById('energy-fill').style.width = (energy / maxEnergy * 100) + '%';
            localStorage.setItem('tap_stars', stars);
            localStorage.setItem('tap_energy', energy);
        }

        // –õ–æ–≥–∏–∫–∞ –∫–ª–∏–∫–∞
        const tapZone = document.getElementById('tap-zone');
        tapZone.addEventListener('touchstart', (e) => {
            if (energy <= 0) {
                tg.HapticFeedback.notificationOccurred('error');
                return;
            }

            // –ú—É–ª—å—Ç–∏—Ç–∞—á –ø–æ–¥–¥–µ—Ä–∂–∫–∞
            for (let i = 0; i < e.touches.length; i++) {
                if (energy > 0) {
                    processTap(e.touches[i].clientX, e.touches[i].clientY);
                }
            }
        });

        function processTap(x, y) {
            stars += 1;
            energy -= 1;
            
            tg.HapticFeedback.impactOccurred('light');
            showPlusOne(x, y);
            updateUI();
        }

        function showPlusOne(x, y) {
            const el = document.createElement('div');
            el.className = 'plus-one';
            el.innerText = '+1';
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);
        }

        // –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏
        setInterval(() => {
            if (energy < maxEnergy) {
                energy = Math.min(maxEnergy, energy + 1);
                updateUI();
            }
        }, 1000);

        // –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if (tg.initDataUnsafe?.user) {
            document.getElementById('u-name').innerText = tg.initDataUnsafe.user.first_name.toUpperCase();
        }

        updateUI();
    </script>
</body>
</html>
