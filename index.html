<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NFT STARS Engine</title>
    <!-- Подключаем игровой движок Phaser -->
    <script src="https://cdn.jsdelivr.net"></script>
    <script src="https://telegram.org"></script>
    <style>
        body { margin: 0; padding: 0; background: #000; overflow: hidden; }
        canvas { display: block; margin: 0 auto; }
        #ui-layer {
            position: absolute; top: 10px; left: 10px;
            color: #fcd535; font-family: sans-serif; font-weight: bold;
            pointer-events: none; z-index: 10;
        }
    </style>
</head>
<body>

    <div id="ui-layer">
        <div>⭐ Stars: <span id="score">0</span></div>
        <div id="user-name">Загрузка...</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        let score = parseInt(localStorage.getItem('engine_stars')) || 0;

        // Конфигурация игрового движка
        const config = {
            type: Phaser.AUTO,
            width: window.innerWidth,
            height: window.innerHeight,
            backgroundColor: '#0b0e11',
            physics: {
                default: 'arcade',
                arcade: { gravity: { y: 300 }, debug: false }
            },
            scene: { preload: preload, create: create, update: update }
        };

        const game = new Phaser.Game(config);

        function preload() {
            // В 2026 используем векторные иконки или ссылки на изображения
            this.load.image('star', 'https://raw.githubusercontent.com');
        }

        function create() {
            document.getElementById('user-name').innerText = tg.initDataUnsafe?.user?.first_name || "Игрок";
            document.getElementById('score').innerText = score;

            // Генерируем падающие звезды
            this.time.addEvent({
                delay: 1000,
                callback: () => {
                    let x = Phaser.Math.Between(50, window.innerWidth - 50);
                    let star = this.physics.add.sprite(x, 0, 'star').setInteractive();
                    star.setBounce(0.4);
                    star.setCollideWorldBounds(true);

                    // Тап по звезде (игровая механика)
                    star.on('pointerdown', function() {
                        score += 1;
                        document.getElementById('score').innerText = score;
                        localStorage.setItem('engine_stars', score);
                        tg.HapticFeedback.impactOccurred('light');
                        this.destroy(); // Удаляем звезду после клика
                    });
                },
                loop: true
            });
        }

        function update() {
            // Логика обновления кадров (если нужна)
        }

        // Адаптация под размер экрана при повороте
        window.addEventListener('resize', () => {
            game.scale.resize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
