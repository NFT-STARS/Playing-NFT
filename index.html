<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Strong Tooth Game</title>
    <style>
        body { 
            margin: 0; padding: 0; background: #e0f0ff; 
            font-family: sans-serif; text-align: center; 
            overflow: hidden; touch-action: none; 
        }
        #score-container { margin-top: 50px; }
        #score { font-size: 60px; font-weight: bold; color: #2c3e50; }
        
        #game-area {
            height: 60vh; display: flex; justify-content: center; align-items: center;
        }

        #tooth-btn {
            width: 180px; height: 200px; background: white;
            border: 6px solid #2c3e50; border-radius: 50px;
            position: relative; cursor: pointer;
            transition: transform 0.05s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            -webkit-tap-highlight-color: transparent;
        }

        #barbell {
            width: 280px; height: 15px; background: #333;
            position: absolute; top: -35px; border-radius: 10px;
            transition: transform 0.05s;
        }
        .weight { width: 30px; height: 70px; background: #222; position: absolute; top: -28px; border-radius: 5px; }
        .w-left { left: 0; } .w-right { right: 0; }

        .eyes-row { display: flex; } /* Контейнер для глаз */
        .eye { width: 15px; height: 15px; background: #2c3e50; border-radius: 50%; margin: 0 20px; }

        /* --- НОВЫЙ СТИЛЬ: РОТ --- */
        #mouth {
            width: 40px; height: 10px; border-bottom: 4px solid #2c3e50; 
            border-radius: 50%; margin-top: 20px; transition: 0.1s;
        }
        .active #mouth { 
            height: 25px; background: #c0392b; border-radius: 50%; border: none; 
        } /* Рот открывается при нажатии */

        .active { transform: scale(0.9) !important; }
        .active #barbell { transform: translateY(-30px); }

        .plus-one {
            position: fixed; color: #27ae60; font-weight: bold; font-size: 30px;
            pointer-events: none; animation: moveUp 0.6s ease-out forwards;
        }
        @keyframes moveUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }
    </style>
</head>
<body>

    <div id="score-container">
        <div id="score">0</div>
        <div style="color: #7f8c8d;">ГАНТЕЛИ</div>
    </div>

    <div id="game-area">
        <div id="tooth-btn">
            <div id="barbell">
                <div class="weight w-left"></div>
                <div class="weight w-right"></div>
            </div>
            <div class="eyes-row">
                <div class="eye"></div>
                <div class="eye"></div>
            </div>
            <!-- ДОБАВИЛИ РОТ -->
            <div id="mouth"></div>
        </div>
    </div>

    <script src="https://telegram.org"></script>
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let count = parseInt(localStorage.getItem('zub_score')) || 0;
        const scoreEl = document.getElementById('score');
        const tooth = document.getElementById('tooth-btn');

        scoreEl.innerText = count;

        function handleTap(e) {
            count++;
            scoreEl.innerText = count;
            localStorage.setItem('zub_score', count);

            // КЛЮЧЕВОЕ ДЕЙСТВИЕ: добавляем класс active. 
            // Благодаря CSS, это изменит и масштаб, и штангу, и рот.
            tooth.classList.add('active');
            setTimeout(() => tooth.classList.remove('active'), 100);

            if (tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('medium');
            }

            const touch = e.touches ? e.touches[0] : e;
            const p = document.createElement('div');
            p.className = 'plus-one';
            p.innerText = '+1';
            p.style.left = touch.clientX + 'px';
            p.style.top = touch.clientY + 'px';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 600);
        }

        tooth.addEventListener('touchstart', (e) => {
            e.preventDefault();
            handleTap(e);
        });
        tooth.addEventListener('mousedown', (e) => {
            handleTap(e);
        });
    </script>
</body>
</html>
