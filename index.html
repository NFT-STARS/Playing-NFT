<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Zub Atlet</title>
    <script src="https://telegram.org"></script>
    <style>
        :root {
            --bg: #f0f8ff;
            --tooth-color: #ffffff;
            --iron: linear-gradient(180deg, #555 0%, #222 100%);
        }

        body {
            margin: 0; padding: 0; background: var(--bg);
            font-family: 'Arial Rounded MT Bold', sans-serif;
            height: 100vh; display: flex; flex-direction: column; align-items: center;
            overflow: hidden; touch-action: none;
        }

        /* Фон */
        .kettlebell-bg {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 80%; opacity: 0.04; z-index: 0; pointer-events: none;
        }

        /* Интерфейс */
        .header { margin-top: 40px; text-align: center; z-index: 2; }
        .score-val { font-size: 60px; color: #2c3e50; font-weight: 900; display: block; }
        .score-label { font-size: 14px; color: #7f8c8d; letter-spacing: 2px; }

        /* Игровая зона */
        .game-area { flex: 1; display: flex; justify-content: center; align-items: center; width: 100%; position: relative; }

        /* ПЕРСОНАЖ */
        .character-box { position: relative; transition: transform 0.1s ease; }
        
        .tooth {
            width: 200px; height: 210px; background: var(--tooth-color);
            border: 6px solid #2c3e50; border-radius: 60px 60px 80px 80px;
            position: relative; z-index: 5; box-shadow: inset -15px -15px 0 #f5f5f5;
        }

        /* Лицо */
        .face { position: absolute; width: 100%; top: 60px; display: flex; justify-content: center; gap: 40px; }
        .eye { 
            width: 16px; height: 24px; background: #2c3e50; border-radius: 50%; 
            animation: blink 4s infinite;
        }
        @keyframes blink {
            0%, 90%, 100% { transform: scaleY(1); }
            95% { transform: scaleY(0.1); }
        }

        .mouth {
            position: absolute; bottom: 60px; left: 50%; transform: translateX(-50%);
            width: 30px; height: 15px; border-bottom: 5px solid #2c3e50; border-radius: 50%;
        }

        /* ШТАНГА */
        .barbell {
            position: absolute; top: -30px; left: -70px; width: 340px; height: 14px;
            background: #bdc3c7; border-radius: 10px; z-index: 10;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); transition: transform 0.1s;
        }
        .weight {
            position: absolute; background: var(--iron); width: 25px; height: 80px;
            border-radius: 5px; top: -33px;
        }
        .w1 { left: 0; } .w2 { left: 30px; width: 20px; height: 60px; top: -23px; }
        .w3 { right: 0; } .w4 { right: 30px; width: 20px; height: 60px; top: -23px; }

        /* МЫШЦЫ */
        .muscles {
            position: absolute; width: 60px; height: 60px; background: #fff;
            border: 5px solid #2c3e50; border-radius: 50%; top: 90px;
            z-index: 1; opacity: 0; transform: scale(0.5); transition: 0.5s;
        }
        .m-left { left: -40px; }
        .m-right { right: -40px; }
        .has-muscles .muscles { opacity: 1; transform: scale(1); }

        /* АНИМАЦИЯ ТАПА */
        .character-box.lifting { transform: scale(0.95); }
        .character-box.lifting .barbell { transform: translateY(-40px); }

        /* Всплывающий текст */
        .plus-one {
            position: absolute; color: #27ae60; font-size: 28px; font-weight: bold;
            pointer-events: none; animation: floatUp 0.6s ease-out forwards; z-index: 100;
        }
        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }
    </style>
</head>
<body>

    <img src="https://cdn-icons-png.flaticon.com" class="kettlebell-bg">

    <div class="header">
        <span class="score-label">ГАНТЕЛИ</span>
        <span class="score-val" id="score">0</span>
    </div>

    <div class="game-area" id="tap-zone">
        <div class="character-box" id="hero">
            <div class="barbell">
                <div class="weight w1"></div><div class="weight w2"></div>
                <div class="weight w3"></div><div class="weight w4"></div>
            </div>
            <div class="tooth">
                <div class="face">
                    <div class="eye"></div>
                    <div class="eye"></div>
                </div>
                <div class="mouth"></div>
            </div>
            <div class="muscles m-left"></div>
            <div class="muscles m-right"></div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let score = parseInt(localStorage.getItem('zub_score')) || 0;
        const scoreDisplay = document.getElementById('score');
        const hero = document.getElementById('hero');
        const tapZone = document.getElementById('tap-zone');

        function updateUI() {
            scoreDisplay.innerText = score;
            if (score >= 50) {
                hero.classList.add('has-muscles');
            }
        }

        function handleTap(e) {
            score++;
            updateUI();
            localStorage.setItem('zub_score', score);

            // Анимация рывка
            hero.classList.remove('lifting');
            void hero.offsetWidth; 
            hero.classList.add('lifting');
            setTimeout(() => hero.classList.remove('lifting'), 100);

            // Текст +1
            const touch = e.touches ? e.touches[0] : e;
            const x = touch.clientX || touch.pageX;
            const y = touch.clientY || touch.pageY;
            
            const p = document.createElement('div');
            p.className = 'plus-one';
            p.innerText = '+1';
            p.style.left = x + 'px';
            p.style.top = y + 'px';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 600);

            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
        }

        tapZone.addEventListener('touchstart', (e) => {
            e.preventDefault();
            handleTap(e);
        });

        // Начальная отрисовка
        updateUI();
    </script>
</body>
</html>
